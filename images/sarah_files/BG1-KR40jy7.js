/*!CK:1083051644!*//*1440989690,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["rfnYY"]); }

__d('UFIReactionIcon.react',['React','UFIReactionTypes','cx','joinClasses'],function a(b,c,d,e,f,g,h,i,j,k){if(c.__markCompiled)c.__markCompiled();var l,m,n=h.PropTypes;l=babelHelpers.inherits(o,h.Component);m=l&&l.prototype;function o(p,q){'use strict';m.constructor.call(this);}o.prototype.render=function(){'use strict';var p=k("_2d1t"+(this.props.size==='tiny'?' '+"_2d1w":'')+(this.props.size==='16'?' '+"_1fxb":'')+(this.props.size==='48'?' '+"_k43":''),i.reactions[this.props.reaction].name,this.props.className);return h.createElement('i',{className:p});};o.propTypes={className:n.string,reaction:n.number.isRequired,size:n.oneOf(['tiny','16','48'])};o.defaultProps={className:null,size:'16'};f.exports=o;},null);
__d('UFIReactionsDialogLayer.react',['AccessibleLayer','BrowserSupport','ContextualDialog','ContextualDialogArrow','ContextualLayerAutoFlip','CSS','LayerRefocusOnHide','ReactLayer','ReactTransitionEvents','SubscriptionsHandler','cx','requestAnimationFrame'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){if(c.__markCompiled)c.__markCompiled();var t="_2r6j",u="_2r6k",v=i.hasCSSAnimations();function w(y){'use strict';this.layer=y;this.onHideEnd=this.onHideEnd.bind(this);this.onShowEnd=this.onShowEnd.bind(this);this.handler=new q();}w.prototype.onHideEnd=function(){'use strict';var y=this.layer.getContentRoot();p.removeEndEventListener(y,this.onHideEnd);s((function(){m.removeClass(y,u);this.layer.finishHide();}).bind(this));};w.prototype.onShowEnd=function(){'use strict';var y=this.layer.getContentRoot();p.removeEndEventListener(y,this.onShowEnd);s(function(){m.removeClass(y,t);});};w.prototype.enable=function(){'use strict';var y=this.layer.getContentRoot();this.handler.addSubscriptions(this.layer.subscribe('beforeshow',(function(){p.addEndEventListener(y,this.onShowEnd);m.addClass(y,t);}).bind(this)),this.layer.subscribe('starthide',(function(){p.addEndEventListener(y,this.onHideEnd);m.addClass(y,u);return false;}).bind(this)));};w.prototype.disable=function(){'use strict';this.handler.release();var y=this.layer.getContentRoot();p.removeEndEventListener(y,this.onHideEnd);p.removeEndEventListener(y,this.onShowEnd);};var x=o.createClass({createLayer:function(y){var z=new j({addedBehaviors:this.enumerateBehaviors({ContextualLayerAutoFlip:l,UFIReactionsDialogLayerTransition:v?w:null}),context:this.props.context,displayName:'UFIReactionsDialog',position:'above',shouldSetARIAProperties:false,theme:{wrapperClassName:"_2r6l"}},y);z.disableBehavior(h);z.disableBehavior(k);z.disableBehavior(n);z.conditionShow(this.props.shown);var aa=new q();aa.addSubscriptions(z.subscribe('mouseenter',this.props.onMouseEnter),z.subscribe('mouseleave',this.props.onMouseLeave),z.subscribe('destroy',function(){aa.release();}));return z;},receiveProps:function(y,z){this.layer.conditionShow(y.shown);}});f.exports=x;},null);
__d('UFIReactionsMenu.react',['React','UFIReactionsDialogLayer.react','UFIReactionIcon.react','UFIReactionTypes','cx'],function a(b,c,d,e,f,g,h,i,j,k,l){if(c.__markCompiled)c.__markCompiled();var m,n;m=babelHelpers.inherits(o,h.Component);n=m&&m.prototype;function o(p,q){'use strict';n.constructor.call(this);this.state={};}o.prototype.onBlur=function(event){'use strict';this.props.onBlur&&this.props.onBlur(event);};o.prototype.onClick=function(p,event){'use strict';event.preventDefault();this.props.onClick&&this.props.onClick(p,event);};o.prototype.render=function(){'use strict';var p=k.ordering.map((function(q){if(!k.reactions[q])return null;q=parseInt(q+'',10);return (h.createElement('a',{className:"_iuw",href:'#',key:'reaction_'+q,onBlur:this.onBlur.bind(this),onClick:this.onClick.bind(this,q)},h.createElement('div',{className:"_d6k"},h.createElement(j,{className:"_iuz",reaction:q,size:'48'}),h.createElement('div',{className:"_d6l"},h.createElement('div',{className:"_4sm1"},k.reactions[q].display_name)))));}).bind(this)).filter(function(q){return q;});return (h.createElement(i,{context:this.props.context,onMouseEnter:this.props.onMouseEnter,onMouseLeave:this.props.onMouseLeave,shown:this.props.shown},h.createElement('div',{className:"_iu-"},p)));};f.exports=o;},null);
__d('UFIReactionsLink.react',['AsyncRequest','BanzaiLogger','Event','InlineBlock.react','React','ReactDOM','ReactLayeredComponentMixin','UFIConstants','UFIReactionIcon.react','UFIReactionsMenu.react','UFIReactionTypes','UFIUserActions','XFeedNUXSaveSeenStateController','XUIAmbientNUX.react','XUIText.react','classWithMixins','cx','fbt','getActiveElement','mixin'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa){if(c.__markCompiled)c.__markCompiled();var ba,ca,da,ea,fa=false,ga=true,ha=500,ia=250;ba=babelHelpers.inherits(ja,w(l.Component,aa(n)));ca=ba&&ba.prototype;function ja(ka,la){'use strict';ca.constructor.call(this);this.hideDialog=this.hideDialog.bind(this);this.showDialog=this.showDialog.bind(this);this.dialogShownTime=0;this.state={dialogShown:false,reaction:ka.reaction,NUXShown:false};fa=ka.hasReactionsNUX;if(!da&&!ea){da=j.listen(window,'blur',(function(){this.focusHandlerLock=true;ga=false;}).bind(this));ea=j.listen(window,'focus',(function(){ga=true;if(z()!==m.findDOMNode(this.refs.trigger))this.focusHandlerLock=false;}).bind(this));}}ja.prototype.componentWillReceiveProps=function(ka){'use strict';this.setState({reaction:ka.reaction});};ja.prototype.renderLayers=function(){'use strict';return {ufiReactionsPopover:l.createElement(q,{context:m.findDOMNode(this.refs.root),onBlur:this.onBlur.bind(this),onClick:this.onReactionChange.bind(this),onMouseEnter:this.onMouseEnter.bind(this),onMouseLeave:this.onMouseLeave.bind(this),selected:this.state.reaction,shown:this.state.dialogShown}),nux:l.createElement(u,{context:m.findDOMNode(this.refs.root),onCloseButtonClick:this.hideNux.bind(this),shown:this.state.NUXShown&&!this.state.dialogShown},l.createElement('div',null,l.createElement(v,{display:'block',weight:'bold'},y._("New! Love, laugh, smile and more...")),l.createElement(v,{display:'block'},y._("Hover over the Like button to see all reactions."))))};};ja.prototype.maybeShowNUX=function(){'use strict';if(fa){fa=false;this.setState({NUXShown:true});var ka=t.getURIBuilder().setString('key','reactions').setBool('seen',true);new h(ka.getURI()).setMethod('POST').send();}};ja.prototype.hideNux=function(){'use strict';this.setState({NUXShown:false});};ja.prototype.hideDialog=function(){'use strict';this.$UFIReactionsLink1(this.state.reaction);clearTimeout(this.hoverTimeout);this.setState({dialogShown:false});};ja.prototype.showDialog=function(){'use strict';if(this.dialogShownTime===0)this.dialogShownTime=Date.now();fa=false;clearTimeout(this.hoverTimeout);this.setState({dialogShown:true,NUXShown:false});};ja.prototype.onReactionChange=function(ka,event){'use strict';this.$UFIReactionsLink1(ka);s.changeReaction(this.props.id,ka,{target:event.target});this.hideDialog();};ja.prototype.onBlur=function(event){'use strict';if(!m.findDOMNode(this.refs.root).contains(z())&&!m.findDOMNode(this.refs.root).contains(event.relatedTarget))this.hideDialog();};ja.prototype.onMouseEnter=function(event){'use strict';if(!ga)return;clearTimeout(this.hoverTimeout);this.hoverTimeout=setTimeout(this.showDialog,ha);};ja.prototype.onMouseLeave=function(event){'use strict';if(!ga)return;clearTimeout(this.hoverTimeout);this.hoverTimeout=setTimeout(this.hideDialog,ia);};ja.prototype.onFocus=function(event){'use strict';if(!this.focusHandlerLock)this.showDialog();this.focusHandlerLock=false;};ja.prototype.setFocusHandlerLock=function(ka){'use strict';this.focusHandlerLock=ka;};ja.prototype.renderTrigger=function(){'use strict';var ka={onBlur:this.onBlur.bind(this),onFocus:this.onFocus.bind(this),onMouseDown:this.setFocusHandlerLock.bind(this,true),onMouseUp:this.setFocusHandlerLock.bind(this,false),onMouseEnter:this.onMouseEnter.bind(this),onMouseLeave:this.onMouseLeave.bind(this),ref:'trigger'};if(!this.state.reaction||this.state.reaction===o.LikeReaction||!r.reactions[this.state.reaction]){var la=l.Children.only(this.props.children);return l.cloneElement(la,Object.assign(babelHelpers._extends({onClick:(function(event){this.hideDialog();this.maybeShowNUX();la.props.onClick(event);}).bind(this)},ka)));}return (l.createElement('a',babelHelpers._extends({className:"UFILikeLink UFILinkBright",href:'#',onClick:this.onReactionChange.bind(this,0)},ka),l.createElement(p,{className:"_1ktw",reaction:this.state.reaction,size:'tiny'}),r.reactions[this.state.reaction].display_name));};ja.prototype.render=function(){'use strict';return (l.createElement(k,{className:'uiContextualLayerParent',ref:'root'},this.renderTrigger()));};ja.prototype.$UFIReactionsLink1=function(ka){'use strict';if(this.dialogShownTime!==0){i.log('UserReactionsLoggerConfig',{feedback_id:this.props.id,final_reaction:ka,initial_reaction:this.state.reaction,'interface':'www',time_spent:Date.now()-this.dialogShownTime});this.dialogShownTime=0;}};f.exports=ja;},null);
__d('UFIReactionsTokens.react',['ActorURI','ProfileBrowserLink','ProfileBrowserTypes','React','Image.react','UFIConstants','UFIReactionIcon.react','UFIReactionTypes','URI','XUFICommentTooltipController','XUFIReactionProfileBrowserController','XUFIReactionProfileDialogController','XUFIReactionTooltipController','XUFIShareTooltipController','cx','fbt','ix'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x){if(c.__markCompiled)c.__markCompiled();var y,z;y=babelHelpers.inherits(aa,k.Component);z=y&&y.prototype;function aa(ba,ca){'use strict';z.constructor.call(this);this.state={hidden:{}};}aa.prototype.componentDidMount=function(){'use strict';this.componentDidMountOrUpdate();};aa.prototype.componentDidUpdate=function(){'use strict';this.componentDidMountOrUpdate();};aa.prototype.componentWillReceiveProps=function(ba){'use strict';if(ba.feedback.reactioncount!==this.props.feedback.reactioncount)this.setState({hidden:{}});};aa.prototype.componentDidMountOrUpdate=function(){'use strict';var ba,ca;if(this.refs.tokens.scrollWidth>this.refs.root.offsetWidth)for(var da=o.ordering.length;da>0;da--){ba=o.ordering[da-1];ca=this.refs['token-'+ba];if(ca&&!this.state.hidden[ba]){var ea=Object.create(this.state.hidden);ea[ba]=true;this.setState({hidden:ea});break;}}};aa.prototype.getHasBlingText=function(){'use strict';return this.props.contextArgs.hasReactionsTokensBling;};aa.prototype.getDialogURI=function(ba){'use strict';var ca=s.getURIBuilder().setString('ft_ent_identifier',this.props.feedback.entidentifier);if(ba)ca.setEnum('reaction_type',ba);return h.create(ca.getURI(),this.props.feedback.actorforpost);};aa.prototype.getPageURI=function(){'use strict';return h.create(r.getURIBuilder().setString('ft_ent_identifier',this.props.feedback.entidentifier).getURI(),this.props.feedback.actorforpost);};aa.prototype.renderEllipsis=function(){'use strict';if(!Object.keys(this.state.hidden).length)return null;return (k.createElement('a',{ajaxify:this.getDialogURI(),'aria-label':w._("See who reacted to this"),className:"_3_vg _3emk _3t52",href:this.getPageURI(),rel:'dialog'},k.createElement(l,{className:"_4-op",height:'16',src:x('images/ufi/reactions/16x16/ellipsis.png'),width:'16'})));};aa.prototype.renderComments=function(){'use strict';if(!this.props.commentCount||this.props.contextArgs.feedbackMode==='expanded')return null;var ba=isNaN(this.props.feedback.commentcountreduced)?this.props.feedback.commentcountreduced:this.props.commentCount,ca=w._({"Comment":"{count} Comment","Comments":"{count} Comments"},[w.param('count',ba),w['enum'](this.props.commentCount===1?'Comment':'Comments',{Comment:'Comment',Comments:'Comments'})]),da=h.create(q.getURIBuilder().setString('ft_ent_identifier',this.props.feedback.entidentifier).getURI(),this.props.feedback.actorforpost);return (k.createElement('a',{'aria-label':ca,className:"_3_vg _3emk _3emm",'data-comment-prelude-ref':this.props['data-comment-prelude-ref'],'data-ft':this.props['data-ft'],'data-hover':'tooltip','data-tooltip-uri':da,href:this.props.permalink,onClick:this.props.onCommentClick,rel:'ignore'},ba));};aa.prototype.renderSeens=function(){'use strict';var ba=this.props.feedback.seencount;if(ba===0||this.props.contextArgs.entstream)return null;var ca=j.GROUP_MESSAGE_VIEWERS,da={id:this.props.feedback.targetfbid},ea=new p('/ajax/ufi/seen_tooltip.php').setQueryData({ft_ent_identifier:this.props.feedback.entidentifier,displayed_count:ba}),fa;if(this.props.feedback.seenbyall){fa=w._("Seen by everyone");}else if(ba===1){fa=w._("Seen by 1");}else fa=w._("Seen by {count}",[w.param('count',ba)]);return (k.createElement('a',{ajaxify:i.constructDialogURI(ca,da),className:"_3_vg",'data-hover':'tooltip','data-tooltip-uri':ea,href:i.constructPageURI(ca,da),rel:'dialog'},fa));};aa.prototype.renderShares=function(){'use strict';if(!this.props.feedback.sharecount)return null;var ba=new p('/ajax/shares/view').setQueryData({target_fbid:this.props.feedback.targetfbid});ba=h.create(ba,this.props.feedback.actorforpost);var ca=new p('/shares/view').setSubdomain('www').setQueryData({id:this.props.feedback.targetfbid});ca=h.create(ca,this.props.feedback.actorforpost);var da=h.create(u.getURIBuilder().setString('ft_ent_identifier',this.props.feedback.entidentifier).getURI(),this.props.feedback.actorforpost),ea=w._({"Share":"{count} Share","Shares":"{count} Shares"},[w.param('count',this.props.feedback.sharecountreduced),w['enum'](this.props.feedback.sharecount===1?'Share':'Shares',{Share:'Share',Shares:'Shares'})]);return (k.createElement('a',{ajaxify:ba,'aria-label':ea,className:"_3_vg _3emk _3emn",'data-hover':'tooltip','data-tooltip-uri':da,href:ca,rel:'dialog'},this.props.feedback.sharecountreduced));};aa.prototype.renderTokens=function(){'use strict';var ba=o.ordering.map((function(ca){if(this.state.hidden[ca]||!this.getHasBlingText()&&ca===m.LikeReaction||!o.reactions[ca]||!this.props.feedback.reactioncountmap[ca]['default'])return null;return this.renderToken(ca);}).bind(this));return ba;};aa.prototype.renderToken=function(ba){'use strict';var ca=h.create(t.getURIBuilder().setString('ft_ent_identifier',this.props.feedback.entidentifier).setEnum('reaction_type',ba).setInt('user_count',this.props.feedback.reactioncountmap[ba]['default']).getURI(),this.props.feedback.actorforpost);return (k.createElement('a',{ajaxify:this.getDialogURI(ba),className:"_3_vg _3emk",'data-hover':'tooltip','data-tooltip-uri':ca,href:this.getPageURI(),key:'reactionType-'+ba,ref:'token-'+ba,rel:'dialog'},k.createElement(n,{className:"_4-op",reaction:ba}),this.props.feedback.reactioncountmap[ba].reduced));};aa.prototype.renderViews=function(){'use strict';var ba=this.props.contextArgs.viewCount;if(!ba)return null;var ca=w._({"View":"{count} View","Views":"{count} Views"},[w.param('count',ba),w['enum'](this.props.feedback.sharecount===1?'View':'Views',{View:'View',Views:'Views'})]),da=w._({"View":"{count} View","Views":"{count} Views"},[w.param('count',this.props.contextArgs.viewCountReduced),w['enum'](this.props.feedback.sharecount===1?'View':'Views',{View:'View',Views:'Views'})]),ea=this.getHasBlingText();return (k.createElement('span',{'aria-label':ca,'data-hover':'tooltip','data-tooltip':ca,className:"_3_vg"+(!ea?' '+"_3emk":'')+(!ea?' '+"_3mju":'')},ea?da:this.props.contextArgs.viewCountReduced));};aa.prototype.render=function(){'use strict';var ba=this.getHasBlingText();return (k.createElement('div',{className:"_3t53"+(ba?' '+"_3_vh":''),ref:'root'},k.createElement('div',{className:"_3t54",ref:'tokens'},this.renderTokens(),this.renderEllipsis(),this.renderComments(),this.renderShares(),k.createElement('div',{className:(ba?"_3_vi":'')+(!ba?' '+"_3_vj":'')},this.renderSeens(),this.renderViews()))));};f.exports=aa;},null);